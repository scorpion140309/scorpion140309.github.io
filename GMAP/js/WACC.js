function C_WACC(){ this.ary_shamei_= new Array("A社", "B社", "C社");this.ary_kingaku_ = new Array([100,50,4,6,50,"???"],[100,50,4,6,50,"???"],[100,50,4,6,50,"???"]);this.ary_itmes_given_ = new Array("D:負債額","E:株式時価総額","rd:負債コスト(%)","re:株主資本(%)","t:法人税率(%)");this.ary_itmes_anser_ = new Array("WACC(%)");this.ary_table_color_ = new Array("#A0A0A0","#FFFFFF");};C_WACC.prototype.sttc_MakeQuestion = function(){var ary_base= [ 50, 50, 3, 5, 50 ];var ary_div= [ 10, 10, 4, 3, 1 ];var ary_scale= [ 10, 10, 1, 1, 1 ];var rd;ns_XorShift.Init();var times = 1;for( i = 0; i < times; i ++ ){ns_XorShift.GetRand();}for( i = 0; i < this.ary_itmes_given_.length; i ++ ){for( s = 0; s < this.ary_shamei_.length; s ++ ){rd = ns_XorShift.GetRand() % ary_div[ i ];this.ary_kingaku_[ s ][ i ] = ary_base[ i ] + ary_scale[ i ] * rd;}rd = ns_XorShift.GetRand() % ary_div[ 3 ];for( s = 0; s < this.ary_shamei_.length; s ++ ){this.ary_kingaku_[ s ][ 3 ] = this.ary_kingaku_[ s ][ 2 ] + rd;}}};C_WACC.prototype.sttc_CalcWACC = function(){for( s = 0; s < this.ary_shamei_.length; s ++ ){var sum_de;var coef_d, coef_e;var rd, re, tax, wacc;sum_de = this.ary_kingaku_[ s ][ 0 ] + this.ary_kingaku_[ s ][ 1 ];coef_d = this.ary_kingaku_[ s ][ 0 ] / sum_de;coef_e = this.ary_kingaku_[ s ][ 1 ] / sum_de;rd = this.ary_kingaku_[ s ][ 2 ] / 100;re = this.ary_kingaku_[ s ][ 3 ] / 100;tax = this.ary_kingaku_[ s ][ 4 ] / 100;wacc = coef_d * ( 1 - tax ) * rd + coef_e * re;this.ary_kingaku_[ s ][ 5 ] = Math.round( 10000 * wacc ) / 100}};C_WACC.prototype.sttc_DispTable = function(){document.write( "<table border='1' >" );document.write( "<tr align='center' bgcolor='", this.ary_table_color_[0], "'>" );document.write( "<td>" );document.write( "</td>" );for( i = 0; i < this.ary_shamei_.length; i ++ ){document.write( "<td>", this.ary_shamei_[ i ], "</td>"  );}document.write( "</tr>" );for( i = 0; i < this.ary_itmes_given_.length; i ++ ){document.write( "<tr>" );document.write( "<td width='150' align='center' bgcolor='", this.ary_table_color_[ 1 ], "'>" );document.write( this.ary_itmes_given_[ i ] );document.write( "</td>" );for( s = 0; s < this.ary_shamei_.length; s ++ ){document.write( "<td width='100' bgcolor='", this.ary_table_color_[ 1 ], "' align='right'>" );document.write( this.ary_kingaku_[ s ][ i ] );     document.write( "</td>" );}document.write( "</tr>" );}for( i = 0; i < this.ary_itmes_anser_.length; i ++ ){document.write( "<tr>" );document.write( "<td bgcolor='", this.ary_table_color_[ 1 ], "' align='center'>" );document.write( this.ary_itmes_anser_[i] );document.write( "</td>" );var offset = this.ary_itmes_given_.length;for( s = 0; s < this.ary_shamei_.length; s ++ ){document.write( "<td bgcolor='", this.ary_table_color_[ 1 ], "' align='right'>" );document.write( "<div class='test_anser'>" );document.write( this.ary_kingaku_[ s ][ offset + i ] );     document.write( "</div>" );document.write( "</td>" );}document.write( "</tr>" );}document.write( "</table>" );};C_WACC.prototype.sttc_DispAnserText = function(){document.write( "<p><div class='test_anser'>" );document.write( "【 WACC 】<BR>" );document.write( "資金を1円調達するのにいくらのコストがかかっているか。<br>" );document.write( "</div></p>" );document.write( "<p><div class='test_anser'>" );document.write( "負債コスト<br>" );document.write( "　企業が事業を行うために調達した資本にかかるコストのうち、債権者より調達した負債に対するコストのこと。<BR>" );document.write( "　法人税に対する節税効果を考慮する。<BR>" );document.write( "　( D / ( D + E ) ) * ( 1 - t ) * rd<BR>" );document.write( "</div></p>" );document.write( "<p><div class='test_anser'>" );document.write( "株主資本コスト<br>" );document.write( "　企業が株式を発行して調達する資金(=株主資本金)にかかるコスト。<BR>" );　document.write( "　( E / ( D + E ) ) * re<BR>" );document.write( "</div></p>" );document.write( "<p><div class='test_anser'>" );document.write( "WACC = ( D / ( D + E ) ) * ( 1 - t ) * rd + ( E / ( D + E ) ) * re<BR>" );document.write( "</div></p>" );}; C_WACC.prototype.Test_WACC = function ( flag_anser ){this.sttc_MakeQuestion();if( flag_anser ){this.sttc_CalcWACC();}this.sttc_DispTable( flag_anser );if( flag_anser != 0 ){this.sttc_DispAnserText();}};
