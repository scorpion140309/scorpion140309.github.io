function C_NPV(){this.ary_shamei_ = new Array("A社", "B社", "C社");this.ary_kingaku_ = new Array([5,-100,10,20,30,"???","???","???","???","???"],[5,-100,10,20,30,"???","???","???","???","???"],[5,-100,10,20,30,"???","???","???","???","???"]);this.ary_itmes_given_ = new Array("割引率(%)","0年目(初期投資)","1年目","2年目","3年目");this.ary_itmes_anser_ = new Array("0年目PV","1年目PV","2年目PV","3年目PV","NPV:正味現在価値");this.ary_table_color_ = new Array("#A0A0A0","#FFFFFF");};C_NPV.prototype.sttc_MakeQuestion = function(){var ary_base= [ 5, -40, 15, 15, 10 ];var ary_div= [ 5,   3,  5,  5,  5 ];var ary_scale= [ 1,   5,  1,  1,  1 ];var rd;ns_XorShift.Init();var times = 1;for( i = 0; i < times; i ++ ){ns_XorShift.GetRand();}for( i = 0; i < this.ary_itmes_given_.length; i ++ ){for( s = 0; s < this.ary_shamei_.length; s ++ ){rd = ns_XorShift.GetRand() % ary_div[ i ];this.ary_kingaku_[ s ][ i ] = ary_base[ i ] + ary_scale[ i ] * rd;}}};C_NPV.prototype.sttc_CalcNPV = function(){var npv = 123;var wacc;var bunbo;var pv = 12;for( s = 0; s < this.ary_shamei_.length; s ++ ){npv = 0;wacc = this.ary_kingaku_[ s ][ 0 ] / 100;bunbo = 1;for( y = 0; y < 4; y ++ ){pv = Math.round( 100 * this.ary_kingaku_[ s ][ 1 + y ] / bunbo ) / 100;this.ary_kingaku_[ s ][ y + 5 ] = pv;npv += pv;bunbo *= ( 1 + wacc );}this.ary_kingaku_[ s ][ 9 ] = pv = Math.round( 100 * npv ) / 100;}};C_NPV.prototype.sttc_DispTable = function( flag_anser ){document.write( "<table border='1' >" );document.write( "<tr align='center' bgcolor='", this.ary_table_color_[0], "'>" );document.write( "<td>" );document.write( "</td>" );for( i = 0; i < this.ary_shamei_.length; i ++ ){document.write( "<td>", this.ary_shamei_[ i ], "</td>"  );}document.write( "</tr>" );for( i = 0; i < this.ary_itmes_given_.length; i ++ ){document.write( "<tr>" );document.write( "<td width='150' align='center' bgcolor='", this.ary_table_color_[ 1 ], "'>" );document.write( this.ary_itmes_given_[ i ] );document.write( "</td>" );for( s = 0; s < this.ary_shamei_.length; s ++ ){document.write( "<td width='100' bgcolor='", this.ary_table_color_[ 1 ], "' align='right'>" );document.write( this.ary_kingaku_[ s ][ i ] );     document.write( "</td>" );}document.write( "</tr>" );}for( i = 0; i < this.ary_itmes_anser_.length; i ++ ){document.write( "<tr>" );document.write( "<td bgcolor='", this.ary_table_color_[ 1 ], "' align='center'>" );document.write( this.ary_itmes_anser_[i] );document.write( "</td>" );var offset = this.ary_itmes_given_.length;for( s = 0; s < this.ary_shamei_.length; s ++ ){document.write( "<td bgcolor='", this.ary_table_color_[ 1 ], "' align='right'>" );document.write( "<div class='test_anser'>" );document.write( this.ary_kingaku_[ s ][ offset + i ] );     document.write( "</div>" );document.write( "</td>" );}document.write( "</tr>" );}document.write( "</table>" );};C_NPV.prototype.sttc_DispAnserText = function(){document.write( "<p><div class='test_anser'>" );document.write( "【 NPV 】<BR>" );document.write( "正味現在価値（Net Present Value:正味現在価値）の計算。<br>" );document.write( "</div></p>" );document.write( "<p><div class='test_anser'>" );document.write( "NPV = Σ ( FCF_i / ( ( 1 + 割引率 )^i )<BR>" );document.write( "( FCF_0 はマイナス)<BR>" );document.write( "</div></p>" );}; C_NPV.prototype.Test_NPV = function( flag_anser ){this.sttc_MakeQuestion();if( flag_anser ){this.sttc_CalcNPV();}this.sttc_DispTable( flag_anser );if( flag_anser != 0 ){this.sttc_DispAnserText();}};
